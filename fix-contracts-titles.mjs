import { drizzle } from 'drizzle-orm/mysql2';
import { mysqlTable, int, text } from 'drizzle-orm/mysql-core';
import { eq } from 'drizzle-orm';

const db = drizzle(process.env.DATABASE_URL);

const contractsLibrary = mysqlTable("contractsLibrary", {
  id: int("id").autoincrement().primaryKey(),
  nameAr: text("nameAr").notNull(),
  nameEn: text("nameEn").notNull(),
});

// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØµØ­ÙŠØ­Ø©
const corrections = [
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¥Ø¯Ø§Ø±Ø©Ø§Ù„ÙÙ†Ø§Ù†", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙ†Ø§Ù†" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¥ØµØ¯Ø§Ø±Ø§Ù„ÙˆØ³Ø§Ø¦Ø·", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙˆØ³Ø§Ø¦Ø·" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ø³ØªØ´Ø§Ø±Ø©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ø³ØªØ´Ø§Ø±Ø©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ø³ØªØ¶Ø§ÙØ©Ø§Ù„ÙˆÙŠØ¨", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ø³ØªØ¶Ø§ÙØ© Ø§Ù„ÙˆÙŠØ¨" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø§Ù…ØªÙŠØ§Ø²", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø§Ù…ØªÙŠØ§Ø²" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªØ¯Ø±ÙŠØ¨", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªØ³ÙˆÙŠØ©ÙˆØ§Ù„Ø¥ÙØ±Ø§Ø¬", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªØ³ÙˆÙŠØ© ÙˆØ§Ù„Ø¥ÙØ±Ø§Ø¬" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªØ¹Ø§Ù‚Ø¯Ù…Ù†Ø§Ù„Ø¨Ø§Ø·Ù†", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ Ù…Ù† Ø§Ù„Ø¨Ø§Ø·Ù†" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªØ¹ÙˆÙŠØ¶", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªØ¹ÙˆÙŠØ¶" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªÙ…Ø«ÙŠÙ„", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªÙ…Ø«ÙŠÙ„" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ØªÙˆØ²ÙŠØ¹", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ØªÙˆØ²ÙŠØ¹" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø®Ø¯Ù…Ø§ØªØ§Ù„Ù…Ù‡Ù†ÙŠØ©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø®Ø¯Ù…Ø§ØªØ§Ù„Ù…Ù‡Ù†ÙŠØ©Ù„Ù„Ù…Ù‚Ø§ÙˆÙ„ÙŠÙ†", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ© Ù„Ù„Ù…Ù‚Ø§ÙˆÙ„ÙŠÙ†" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø±Ø¹Ø§ÙŠØ©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø±Ø¹Ø§ÙŠØ©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø´Ø±Ø§ÙƒØ©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø´Ø±Ø§ÙƒØ©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ø¹Ù…Ù„Ø§Ù„Ø­Ø±", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø±" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ù…Ø³Ø§Ù‡Ù…", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ù‡Ù…" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„Ù…Ø´Ø±ÙˆØ¹Ø§Ù„Ù…Ø´ØªØ±Ùƒ", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…Ø´ØªØ±Ùƒ" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø§Ù„ÙˆØ³Ø§Ø·Ø©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„ÙˆØ³Ø§Ø·Ø©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¨ÙŠØ¹Ø§Ù„Ø£Ø³Ù‡Ù…", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¨ÙŠØ¹ Ø§Ù„Ø£Ø³Ù‡Ù…" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªØ­ÙƒÙŠÙ…", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªØ­ÙƒÙŠÙ…" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªØ·ÙˆÙŠØ±Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªØ·ÙˆÙŠØ±Ø§Ù„Ù…Ù†ØªØ¬", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªØ¹Ø§ÙˆÙ†ØªØ¬Ø§Ø±ÙŠ", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªØ¹Ø§ÙˆÙ† ØªØ¬Ø§Ø±ÙŠ" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªØ¹ÙˆÙŠØ¶Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªØ¹ÙˆÙŠØ¶ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªÙ‚Ø¯ÙŠÙ…Ø§Ù„Ø·Ø¹Ø§Ù…", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ø¹Ø§Ù…" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªÙ‚Ø¯ÙŠÙ…Ø§Ù„Ù…Ø´ÙˆØ±Ø©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù…Ø´ÙˆØ±Ø©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©ØªÙ…ÙˆÙŠÙ„", new: "Ø§ØªÙØ§Ù‚ÙŠØ© ØªÙ…ÙˆÙŠÙ„" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø®Ø¯Ù…Ø§ØªØ§Ù„ØªØ³ÙˆÙŠÙ‚", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ³ÙˆÙŠÙ‚" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø®Ø¯Ù…Ø§ØªØ§Ù„Ø¹Ù…Ù„Ø§Ø¡", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø®Ø¯Ù…Ø§ØªØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø®Ø¯Ù…Ø§Øª ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø´Ø±Ø§Ø¡Ø§Ù„Ø£ØµÙˆÙ„", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£ØµÙˆÙ„" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø´Ø±Ø§ÙƒØ©Ù…Ø­Ø¯ÙˆØ¯Ø©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ø±Ø§ÙƒØ© Ù…Ø­Ø¯ÙˆØ¯Ø©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¹Ø¯Ù…Ø§Ù„Ø¥ÙØµØ§Ø­", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¹Ø¯Ù… Ø§Ù„Ø¥ÙØµØ§Ø­" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¹Ø¯Ù…Ø§Ù„ØªÙ†Ø§ÙØ³", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¹Ø¯Ù… Ø§Ù„ØªÙ†Ø§ÙØ³" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¹Ø¯Ù…Ø§Ù„Ø·Ù„Ø¨", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¹Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ø¹Ø¶ÙˆÙŠØ©Ø§Ù„Ù†Ø§Ø¯ÙŠ", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ù†Ø§Ø¯ÙŠ" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ù‚Ø±Ø¶Ø´Ø®ØµÙŠ", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ù‚Ø±Ø¶ Ø´Ø®ØµÙŠ" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ù…Ø³ØªÙˆÙ‰Ø§Ù„Ø®Ø¯Ù…Ø©", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø¯Ù…Ø©" },
  { old: "Ø§ØªÙØ§Ù‚ÙŠØ©Ù†Ù‚Ù„Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§", new: "Ø§ØªÙØ§Ù‚ÙŠØ© Ù†Ù‚Ù„ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§" },
];

async function fix() {
  console.log('ğŸ”§ Fixing contract titles...');
  
  let fixed = 0;
  for (const correction of corrections) {
    try {
      const contracts = await db.select().from(contractsLibrary).where(eq(contractsLibrary.nameAr, correction.old));
      
      if (contracts.length > 0) {
        await db.update(contractsLibrary)
          .set({ nameAr: correction.new })
          .where(eq(contractsLibrary.nameAr, correction.old));
        
        console.log(`âœ… Fixed: ${correction.old} â†’ ${correction.new}`);
        fixed++;
      }
    } catch (error) {
      console.error(`âŒ Error fixing "${correction.old}":`, error.message);
    }
  }
  
  console.log(`\nâœ¨ Fixed ${fixed} contract titles!`);
  process.exit(0);
}

fix().catch((error) => {
  console.error('âŒ Fix failed:', error);
  process.exit(1);
});
